{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport async function getImages(value, page) {\n  const res = await axios.get('/api/', {\n    params: {\n      key: \"44352919-dbe9ef0ac86097ad22a8e9457\",\n      q: value,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      per_page: 15,\n      page: page\n    }\n  });\n\n  return res.data;\n}\n\n","export function renderImage(data) {\n  return data.map(image => `<li class=\"gallery-item\">\n      <div class=\"image-cont\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n        </a>\n        <div class=\"image-descr\">\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Likes</p>\n            <p class=\"image-data\">${image.likes}</p>\n          </div>\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Views</p>\n            <p class=\"image-data\">${image.views}</p>\n          </div>\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Comments</p>\n            <p class=\"image-data\">${image.comments}</p>\n          </div>\n          <div class=\"descr-box\">\n            <p class=\"image-feature\">Downloads</p>\n              <p class=\"image-data\">${image.downloads}</p>\n          </div>\n        </div>\n      </div>\n    </li>\n  `).join('');\n}","'use strict';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getImages } from \"./js/pixabay-api\";\nimport { renderImage } from \"./js/render-functions\";\n\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst form = document.querySelector('.search-form');\nconst input = document.querySelector('.search-input');\nconst list = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader')\n\nlet currentPage;\nlet currentQuery = '';\nlet maxPage;\nconst perPage = 15;\n\n// render gallery\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  currentQuery = event.target.elements.query.value.trim();\n  currentPage = 1;\n\n  showLoader();\n  hideLoadBtn();\n  list.innerHTML = '';\n\n  if (currentQuery === '') {\n    iziToast.error({\n      position: \"topRight\",\n      message: 'Please enter some text',\n    });\n    hideLoader();\n    return;\n  }\n\n  try {\n    const data = await getImages(currentQuery, currentPage);\n    maxPage = Math.ceil(data.totalHits / perPage);\n\n    if (data.hits && data.hits.length > 0) {\n      const markup = renderImage(data.hits);\n      list.insertAdjacentHTML(\"beforeend\", markup);\n\n      hideLoader();\n      hideLoadBtn();\n\n      let lightbox = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionDelay: 250,\n        captionPosition: 'bottom',\n        captionsData: 'alt',\n      });\n\n      lightbox.refresh();\n    } else {\n      iziToast.error({\n        position: \"topRight\",\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      })\n      hideLoader();\n    }\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      position: \"topRight\",\n      message: 'Sorry, the request can\\'t be completed at this time. Please try again',\n    })\n  }\n\n  input.value = '';\n  showLoadBtn();\n  updateBtnStatus();\n});\n\n// add images on a button 'load more'\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n  showLoader();\n  hideLoadBtn();\n\n  try {\n    const data = await getImages(currentQuery, currentPage);\n    const markup = renderImage(data.hits);\n    list.insertAdjacentHTML(\"beforeend\", markup);\n    scrollPage();\n  } catch (err) {\n    console.log(err);\n  }\n\n  hideLoader();\n  updateBtnStatus();\n});\n\n// service functions\n\nfunction showLoadBtn() {\n  loadMoreBtn.classList.remove('visually-hidden');\n}\n\nfunction hideLoadBtn() {\n  loadMoreBtn.classList.add('visually-hidden');\n}\n\nfunction showLoader() {\n  loader.classList.remove('visually-hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('visually-hidden');\n}\n\nfunction updateBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadBtn();\n\n    if (maxPage) {\n      iziToast.info({\n        position: \"bottomRight\",\n        message: 'We\\'re sorry, but you\\'ve reached the end of search results',\n      })\n    hideLoadBtn();\n    }\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction scrollPage() {\n  const liElem = list.children[0];\n  const height = liElem.getBoundingClientRect().height;\n\n  scrollBy({\n    top: height * 2,\n    behavior: \"smooth\",\n  });\n}\n\n"],"names":["axios","getImages","value","page","renderImage","data","image","loadMoreBtn","form","input","list","loader","currentPage","currentQuery","maxPage","perPage","event","showLoader","hideLoadBtn","iziToast","hideLoader","markup","SimpleLightbox","err","showLoadBtn","updateBtnStatus","scrollPage","height"],"mappings":"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"}